<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Display idiomatic code to construct most R objects.">
<title>Display Idiomatic Code to Construct Most R Objects • constructive</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Display Idiomatic Code to Construct Most R Objects">
<meta property="og:description" content="Display idiomatic code to construct most R objects.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">constructive</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/cynkra/constructive/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="constructive">constructive<a class="anchor" aria-label="anchor" href="#constructive"></a>
</h1></div>
<p>{constructive} prints code that can be used to recreate R objects. In a sense it is similar to <code><a href="https://rdrr.io/r/base/dput.html" class="external-link">base::dput()</a></code> but {constructive} strives to use “natural” constructors (<code>factor</code> for factors, <code><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date()</a></code> for dates, <code><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame()</a></code> for data frames etc), in order to get output readable by humans.</p>
<p>Some use cases are:</p>
<ul>
<li>Snapshot tests</li>
<li>Exploring objects (alternative to <code><a href="https://rdrr.io/r/base/dput.html" class="external-link">dput()</a></code> or <code><a href="https://rdrr.io/r/utils/str.html" class="external-link">str()</a></code>)</li>
<li>Creating reproducible examples from existing data</li>
<li>Comparing two objects (using <code><a href="reference/construct_diff.html">construct_diff()</a></code>)</li>
</ul>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Install with:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>remotes<span class="op">::</span><span class="kw">install_github</span>(<span class="st">"cynkra/constructive"</span>)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<p>A few examples compared to their <code><a href="https://rdrr.io/r/base/dput.html" class="external-link">dput()</a></code> output.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/cynkra/constructive" class="external-link">constructive</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/construct.html">construct</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; data.frame(</span></span>
<span><span class="co">#&gt;   Sepal.Length = c(5.1, 4.9),</span></span>
<span><span class="co">#&gt;   Sepal.Width = c(3.5, 3),</span></span>
<span><span class="co">#&gt;   Petal.Length = c(1.4, 1.4),</span></span>
<span><span class="co">#&gt;   Petal.Width = c(0.2, 0.2),</span></span>
<span><span class="co">#&gt;   Species = factor(c("setosa", "setosa"), levels = c("setosa", "versicolor", "virginica"))</span></span>
<span><span class="co">#&gt; )</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dput.html" class="external-link">dput</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; structure(list(Sepal.Length = c(5.1, 4.9), Sepal.Width = c(3.5, </span></span>
<span><span class="co">#&gt; 3), Petal.Length = c(1.4, 1.4), Petal.Width = c(0.2, 0.2), Species = structure(c(1L, </span></span>
<span><span class="co">#&gt; 1L), levels = c("setosa", "versicolor", "virginica"), class = "factor")), row.names = 1:2, class = "data.frame")</span></span>
<span></span>
<span><span class="fu"><a href="reference/construct.html">construct</a></span><span class="op">(</span><span class="va">.leap.seconds</span><span class="op">)</span></span>
<span><span class="co">#&gt; as.POSIXct(</span></span>
<span><span class="co">#&gt;   c(</span></span>
<span><span class="co">#&gt;     "1972-07-01", "1973-01-01", "1974-01-01", "1975-01-01", "1976-01-01",</span></span>
<span><span class="co">#&gt;     "1977-01-01", "1978-01-01", "1979-01-01", "1980-01-01", "1981-07-01",</span></span>
<span><span class="co">#&gt;     "1982-07-01", "1983-07-01", "1985-07-01", "1988-01-01", "1990-01-01",</span></span>
<span><span class="co">#&gt;     "1991-01-01", "1992-07-01", "1993-07-01", "1994-07-01", "1996-01-01",</span></span>
<span><span class="co">#&gt;     "1997-07-01", "1999-01-01", "2006-01-01", "2009-01-01", "2012-07-01",</span></span>
<span><span class="co">#&gt;     "2015-07-01", "2017-01-01"</span></span>
<span><span class="co">#&gt;   ),</span></span>
<span><span class="co">#&gt;   tz = "GMT"</span></span>
<span><span class="co">#&gt; )</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dput.html" class="external-link">dput</a></span><span class="op">(</span><span class="va">.leap.seconds</span><span class="op">)</span></span>
<span><span class="co">#&gt; structure(c(78796800, 94694400, 126230400, 157766400, 189302400, </span></span>
<span><span class="co">#&gt; 220924800, 252460800, 283996800, 315532800, 362793600, 394329600, </span></span>
<span><span class="co">#&gt; 425865600, 489024000, 567993600, 631152000, 662688000, 709948800, </span></span>
<span><span class="co">#&gt; 741484800, 773020800, 820454400, 867715200, 915148800, 1136073600, </span></span>
<span><span class="co">#&gt; 1230768000, 1341100800, 1435708800, 1483228800), class = c("POSIXct", </span></span>
<span><span class="co">#&gt; "POSIXt"), tzone = "GMT")</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">grouped_band_members</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">band_members</span>, <span class="va">band</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dput.html" class="external-link">dput</a></span><span class="op">(</span><span class="va">grouped_band_members</span><span class="op">)</span></span>
<span><span class="co">#&gt; structure(list(name = c("Mick", "John", "Paul"), band = c("Stones", </span></span>
<span><span class="co">#&gt; "Beatles", "Beatles")), class = c("grouped_df", "tbl_df", "tbl", </span></span>
<span><span class="co">#&gt; "data.frame"), row.names = c(NA, -3L), groups = structure(list(</span></span>
<span><span class="co">#&gt;     band = c("Beatles", "Stones"), .rows = structure(list(2:3, </span></span>
<span><span class="co">#&gt;         1L), ptype = integer(0), class = c("vctrs_list_of", "vctrs_vctr", </span></span>
<span><span class="co">#&gt;     "list"))), class = c("tbl_df", "tbl", "data.frame"), row.names = c(NA, </span></span>
<span><span class="co">#&gt; -2L), .drop = TRUE))</span></span>
<span><span class="fu"><a href="reference/construct.html">construct</a></span><span class="op">(</span><span class="va">grouped_band_members</span><span class="op">)</span></span>
<span><span class="co">#&gt; tibble::tibble(name = c("Mick", "John", "Paul"), band = c("Stones", "Beatles", "Beatles")) |&gt;</span></span>
<span><span class="co">#&gt;   dplyr::group_by(band)</span></span></code></pre></div>
<p>We can provide to the <code>data</code>argument a list, environment, or package where to look for data so we don’t print more than necessary, for instance improving the previous example:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/construct.html">construct</a></span><span class="op">(</span><span class="va">grouped_band_members</span>, data <span class="op">=</span> <span class="st">"dplyr"</span><span class="op">)</span></span>
<span><span class="co">#&gt; band_members |&gt;</span></span>
<span><span class="co">#&gt;   dplyr::group_by(band)</span></span></code></pre></div>
<p>We can also trim the output and display only <code>max_atomic</code> elements at most from a vector, or <code>max_list</code> elements from a list. Notice the last element of trimmed objects, prefixed by <code>+</code>, showing how many items were not printed.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/construct.html">construct</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="va"><a href="https://dplyr.tidyverse.org/reference/starwars.html" class="external-link">starwars</a></span>, max_atomic <span class="op">=</span> <span class="fl">2</span>, max_list <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt; tibble::tibble(</span></span>
<span><span class="co">#&gt;   name = c("Luke Skywalker", "C-3PO", +85),</span></span>
<span><span class="co">#&gt;   height = c(172L, 167L, +85),</span></span>
<span><span class="co">#&gt;   mass = c(77, 75, +85),</span></span>
<span><span class="co">#&gt;   hair_color = c("blond", NA, +85),</span></span>
<span><span class="co">#&gt;   skin_color = c("fair", "gold", +85),</span></span>
<span><span class="co">#&gt;   eye_color = c("blue", "yellow", +85),</span></span>
<span><span class="co">#&gt;   birth_year = c(19, 112, +85),</span></span>
<span><span class="co">#&gt;   sex = c("male", "none", +85),</span></span>
<span><span class="co">#&gt;   gender = c("masculine", "masculine", +85),</span></span>
<span><span class="co">#&gt;   homeworld = c("Tatooine", "Tatooine", +85),</span></span>
<span><span class="co">#&gt;   species = c("Human", "Droid", +85),</span></span>
<span><span class="co">#&gt;   films = list(c("The Empire Strikes Back", "Revenge of the Sith", +3), +86),</span></span>
<span><span class="co">#&gt;   vehicles = list(c("Snowspeeder", "Imperial Speeder Bike"), +86),</span></span>
<span><span class="co">#&gt;   starships = list(c("X-wing", "Imperial shuttle"), +86),</span></span>
<span><span class="co">#&gt; )</span></span></code></pre></div>
<p>If we set those to <code>0</code> we build a prototype :</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/construct.html">construct</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="va"><a href="https://dplyr.tidyverse.org/reference/starwars.html" class="external-link">starwars</a></span>, max_atomic <span class="op">=</span> <span class="fl">0</span>, max_list <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="co">#&gt; tibble::tibble(</span></span>
<span><span class="co">#&gt;   name = character(0),</span></span>
<span><span class="co">#&gt;   height = integer(0),</span></span>
<span><span class="co">#&gt;   mass = numeric(0),</span></span>
<span><span class="co">#&gt;   hair_color = character(0),</span></span>
<span><span class="co">#&gt;   skin_color = character(0),</span></span>
<span><span class="co">#&gt;   eye_color = character(0),</span></span>
<span><span class="co">#&gt;   birth_year = numeric(0),</span></span>
<span><span class="co">#&gt;   sex = character(0),</span></span>
<span><span class="co">#&gt;   gender = character(0),</span></span>
<span><span class="co">#&gt;   homeworld = character(0),</span></span>
<span><span class="co">#&gt;   species = character(0),</span></span>
<span><span class="co">#&gt;   films = list(),</span></span>
<span><span class="co">#&gt;   vehicles = list(),</span></span>
<span><span class="co">#&gt;   starships = list(),</span></span>
<span><span class="co">#&gt; )</span></span></code></pre></div>
<p>Some other options :</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/construct.html">construct</a></span><span class="op">(</span><span class="va">band_members</span>, tribble <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; tibble::tribble(</span></span>
<span><span class="co">#&gt;   ~name,  ~band,</span></span>
<span><span class="co">#&gt;   "Mick", "Stones",</span></span>
<span><span class="co">#&gt;   "John", "Beatles",</span></span>
<span><span class="co">#&gt;   "Paul", "Beatles",</span></span>
<span><span class="co">#&gt; )</span></span>
<span><span class="fu"><a href="reference/construct.html">construct</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">band_members</span><span class="op">)</span>, read.table <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; read.table(header = TRUE, text = "</span></span>
<span><span class="co">#&gt; name band</span></span>
<span><span class="co">#&gt; Mick Stones</span></span>
<span><span class="co">#&gt; John Beatles</span></span>
<span><span class="co">#&gt; Paul Beatles</span></span>
<span><span class="co">#&gt; ")</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="limitations">Limitations<a class="anchor" aria-label="anchor" href="#limitations"></a>
</h2>
<p>Environments are not always possible to reproduce but we support some common cases. Due to this several objects such as formulas, srcrefs, R6 objects, ggplot objects etc might not be reproducible exactly. If an approximation is enough one might set <code>check = FALSE</code> (don’t fail if object cannot be reproduced), <code>ignore_srcref = TRUE</code> (don’t fail if srcrefs are different), <code>env_as_list = FALSE</code> (don’t attempt to recreate fancy environments, simply use <code><a href="https://rdrr.io/r/base/environment.html" class="external-link">new.env()</a></code> instead).</p>
</div>
<div class="section level2">
<h2 id="construct_diff">construct_diff<a class="anchor" aria-label="anchor" href="#construct_diff"></a>
</h2>
<p><code><a href="reference/construct_diff.html">construct_diff()</a></code> highlights the differences in the code used to produce 2 objects.</p>
<p>Let’s try it on ggplot objects, these objects are very complex and {constructive} cannot reproduce them exactly (because environments can’t be reproduced reliably) but we can get close enough to see how adding a geom changes the structure of the object.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="reference/construct_diff.html">construct_diff</a></span><span class="op">(</span></span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="va">cars</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">speed</span>, <span class="va">dist</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu">ggplot</span><span class="op">(</span><span class="va">cars</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">speed</span>, <span class="va">dist</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  max_atomic <span class="op">=</span> <span class="fl">3</span>, </span>
<span>  env_as_list <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co">#  -&gt; use `new.env()` to produce env objects</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/construct_diff.png"></p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/cynkra/constructive/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/cynkra/constructive/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing constructive</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Antoine Fabri <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Antoine Fabri.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
