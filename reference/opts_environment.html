<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Constructive options for type 'environment'"><title>Constructive options for type 'environment' — opts_environment • constructive</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Constructive options for type 'environment' — opts_environment"><meta property="og:description" content="Constructive options for type 'environment'"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">constructive</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/cynkra/constructive/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Constructive options for type 'environment'</h1>
      <small class="dont-index">Source: <a href="https://github.com/cynkra/constructive/blob/HEAD/R/environment.R" class="external-link"><code>R/environment.R</code></a></small>
      <div class="d-none name"><code>opts_environment.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Constructive options for type 'environment'</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">opts_environment</span><span class="op">(</span></span>
<span>  constructor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"list2env"</span>, <span class="st">"as.environment"</span>, <span class="st">"new.env"</span>, <span class="st">"topenv"</span>, <span class="st">"new_environment"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  recurse <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>constructor</dt>
<dd><p>String. Name of the function used to construct the environment, see Details section.</p></dd>


<dt>...</dt>
<dd><p>Should not be used. Forces passing arguments by name.</p></dd>


<dt>recurse</dt>
<dd><p>Boolean. Only considered if <code>constructor</code> is <code>"list2env"</code> or <code>"new_environment"</code>. Whether to
attempt to recreate all parent environments until a known environment is found,
if <code>FALSE</code> (the default) we will use <code><a href="https://rdrr.io/r/base/ns-topenv.html" class="external-link">topenv()</a></code> to find a known ancestor to set as
the parent.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An object of class &lt;constructive_options/constructive_options_environment&gt;</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Environments use reference semantics, they cannot be copied.
An attempt to copy an environment would indeed yield a different environment and <code>identical(env, copy)</code> would be <code>FALSE</code>.<br>
Moreover every environment (except for <code><a href="https://rdrr.io/r/base/environment.html" class="external-link">emptyenv()</a></code>) has a
parent and thus to copy the environment we'd have to have a way to point to
the parent, or copy it too.<br>
For this reason environments are constructive's cryptonite. They make some objects
impossible to reproduce exactly. And since every function or formula has one they're hard to
avoid <br>
Luckily in many cases we don't need a perfect copy of an environment to reproduce
an object faithfully from a practical standpoint, and in a some cases we might build
code that points to a specific environment such as <code>.GlobalEnv</code> or a given namespace.<br>
constructive will not signal any difference if it can reproduce an equivalent environment,
defined as containing the same values and having a same or equivalent parent.<br>
See also the <code>ignore_function_env</code> argument in <code><a href="construct.html">?construct</a></code>, which disables the check
of environments of function.</p>
<p>Environment construction works as follows:</p><ul><li><p>Special environments <code>.GlobalEnv</code>, <code>.BaseNamespaceEnv</code>, <code><a href="https://rdrr.io/r/base/environment.html" class="external-link">baseenv()</a></code> and
<code><a href="https://rdrr.io/r/base/environment.html" class="external-link">emptyenv()</a></code> are used whenever possible.</p></li>
<li><p>The idiom <code>asNamespace("pkg")</code> is
used whenever possible.</p></li>
<li><p>The idiom <code>as.environment("package:pkg")</code> is used
whenever possible.</p></li>
<li><p>The <code>constructor</code> argument is used to recreate a similar environment whenever
the above conditions are not met.</p></li>
</ul><p>Depending on <code>constructor</code>, we construct the environment as follows:</p><ul><li><p><code>"list2env"</code> (default): We construct the environment as a list then
use <code><a href="https://rdrr.io/r/base/list2env.html" class="external-link">base::list2env()</a></code> to convert it to an environment and assign it a parent. By
default we will use <code><a href="https://rdrr.io/r/base/ns-topenv.html" class="external-link">base::topenv()</a></code> to construct a parent. If <code>recurse</code> is <code>TRUE</code>
the parent will be built recursively so all ancestors will be created until
we meet a known environment, this might be verbose and will fail if environments
are nested too deep or have a circular relationship, but if it works it's the
most faithful method. If the environment is empty we use <code>new.env(parent=)</code>
for a more economic syntax.</p></li>
<li><p><code>"new_environment"</code> : Similar to the above, but using <code><a href="https://rlang.r-lib.org/reference/env.html" class="external-link">rlang::new_environment()</a></code>.</p></li>
<li><p><code>"new.env"</code> : All environments will be recreated with the code <code>"base::new.env()"</code>, effectively creating an empty environment child of
the local (often global) environment. This is enough in cases where the environment
doesn't matter at all (or matters as long as it inherits from the local environment),
this is the case for most formulas. <code>recurse</code> is ignored.</p></li>
<li><p><code>"as.environment"</code> : we attempt to construct the environment as a list and use
<code><a href="https://rdrr.io/r/base/as.environment.html" class="external-link">base::as.environment()</a></code> on top of it, as in <code>as.environment(list(a=1, b=2))</code>, it will
contain the same variables as the original environment but the parent will be the
<code><a href="https://rdrr.io/r/base/environment.html" class="external-link">emptyenv()</a></code>. <code>recurse</code> is ignored.</p></li>
<li><p><code>"topenv"</code> : we construct <code>base::topenv(x)</code>, see <code><a href="https://rdrr.io/r/base/ns-topenv.html" class="external-link">?topenv</a></code>. <code>recurse</code> is ignored.</p></li>
</ul></div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Antoine Fabri.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

