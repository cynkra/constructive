% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/construct_serialize.R
\name{construct_serialize}
\alias{construct_serialize}
\title{Build code to recreate an object from its serialized form}
\usage{
construct_serialize(x, collapse_header = FALSE)
}
\arguments{
\item{x}{An R object to serialize and reconstruct.}

\item{collapse_header}{Logical. If \code{TRUE}, the serialization header is displayed
as a single collapsed line (\code{c(0x58, 0x0a, ..., 0x38)}). If \code{FALSE} (default),
the header is displayed with detailed comments explaining each component.}
}
\value{
An object of class \code{"constructive_code"} containing the generated code
as a character vector. Each element is one line of code.
}
\description{
\code{construct_serialize()} creates code that reconstructs an R object by serializing
it to raw bytes and then calling \code{unserialize()}. This is a fallback method that
works for almost any R object, including those that are difficult or impossible
to construct idiomatically.
}
\details{
This function generates code in the form:

\if{html}{\out{<div class="sourceCode r">}}\preformatted{unserialize(as.raw(c(
  # --- HEADER ---
  c(0x58, 0x0a, ...),
  # --- DATA ---
  c(0x00, 0x00, ...)
)))
}\if{html}{\out{</div>}}

The generated code includes detailed comments explaining the binary structure,
making it useful for understanding R's serialization format.
\subsection{When to use construct_serialize()}{

Use \code{construct_serialize()} when:
\itemize{
\item You need a guaranteed way to reconstruct any R object
\item Idiomatic construction is unavailable or produces incorrect results
\item You want to understand R's serialization format
\item You need to preserve exact binary representation (e.g., special NA values)
}

Prefer \code{construct()} when:
\itemize{
\item You want readable, idiomatic R code
\item The object has a natural constructor (e.g., \code{data.frame()}, \code{matrix()})
\item You're sharing code with others who need to understand it
}
}

\subsection{Supported Types}{

\code{construct_serialize()} supports all commonly used R object types:
\itemize{
\item \strong{Atomic vectors}: character, logical, integer, numeric, complex, raw
\item \strong{Special values}: NULL, NA, NaN, Inf, -Inf, -0 (negative zero)
\item \strong{Containers}: lists, pairlists, data.frames
\item \strong{Attributes}: names, class, dim, dimnames, custom attributes
\item \strong{Functions}: closures, builtins (sum, length), special forms (if, for)
\item \strong{Expressions}: symbols, language objects (calls), expression vectors
\item \strong{Environments}: global environment references, custom environments
\item \strong{Advanced}: ALTREP sequences (1:n), references, factors, dates, formulas
}
}

\subsection{Limitations}{

Some R objects cannot be fully serialized:
\itemize{
\item \strong{External pointers}: Cannot be reconstructed in a new session
\item \strong{Namespace environments}: May reference package-specific state
\item \strong{Active bindings}: The binding mechanism isn't preserved
\item \strong{Connections}: File handles and network connections
\item \strong{Promises}: Unevaluated function arguments
}

For these cases, \code{unserialize()} may return a placeholder or fail.
}
}
\examples{
# Simple objects
construct_serialize(1:5)
construct_serialize(c("hello", "world"))

# Complex objects
construct_serialize(data.frame(a = 1:3, b = letters[1:3]))
construct_serialize(matrix(1:6, nrow = 2))

# Objects with attributes
x <- c(a = 1, b = 2, c = 3)
construct_serialize(x)

# Expressions and calls
construct_serialize(quote(mean(x)))
construct_serialize(expression(x + 1, y * 2))

# Special values
construct_serialize(c(NA, NaN, Inf, -Inf))

# Builtin functions
construct_serialize(sum)
construct_serialize(`if`)

# The generated code can be evaluated to reconstruct the object
code <- construct_serialize(iris)
reconstructed <- eval(parse(text = paste(code, collapse = "\n")))
identical(reconstructed, iris)
}
\seealso{
\code{\link[=construct]{construct()}} for idiomatic object construction, \code{\link[=serialize]{serialize()}} for
the underlying serialization mechanism.
}
